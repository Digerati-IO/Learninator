<!DOCTYPE HTML>
<html>
<head>
    <title>Tilemap</title>
    <style>
        body {
            margin: 0;
            padding: 0;
        }

        canvas {
            border: 5px solid #000000;
        }
    </style>

    <link rel="stylesheet" href="//storage.googleapis.com/code.getmdl.io/1.0.1/material.indigo-pink.min.css">
    <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">

    <script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
    <script src="//cdnjs.cloudflare.com/ajax/libs/pixi.js/3.0.11/pixi.min.js"></script>
    <link rel="import" href="/templates/twitch-nav.html">
</head>
<body>
<div id="container">
<p id="demo"></p>
<script>
    // For zoomed-in pixel art, we want crisp pixels instead of fuzziness
    PIXI.SCALE_MODES.DEFAULT = PIXI.SCALE_MODES.NEAREST;

    var tileMapOpts = {
                tileMap: {
                    path: "img/tiles.json",
                    size: 16,
                    width: 64,
                    height: 50
                },
                render: {
                    width: 800,
                    height: 600
                },
                menu: {
                    width: 120
                }
            },
            stage = new PIXI.Container(),
            renderer = PIXI.autoDetectRenderer(tileMapOpts.render.width, tileMapOpts.render.height),
            tileAtlas = [tileMapOpts.tileMap.path],
            loader = PIXI.loader.add(tileMapOpts.tileMap.path).load(onLoaded);

    renderer.backgroundColor = 0xFFFFFF;
    document.body.appendChild(renderer.view);

    loader.load();

    // called when sprites are finished loading
    function onLoaded() {
        var tilemap = new TileMap(tileMapOpts);
        tilemap.position.x = tileMapOpts.menu.width;
        stage.addChild(tilemap);

        var menu = new Menu(tilemap, tileMapOpts);
        tilemap.menu = menu;
        stage.addChild(menu);

        // zoom in on the starting tile
        tilemap.selectTile(tilemap.startLocation.x, tilemap.startLocation.y);
        tilemap.zoomIn();

        // begin drawing
        requestAnimationFrame(animate);
    }

    function animate() {
        requestAnimationFrame(animate);
        renderer.render(stage);
    }

    $("#demo").append(renderer.view);
</script>
</div>

<script src="//code.jquery.com/jquery-2.1.4.min.js"></script>
<script src="//code.jquery.com/ui/1.11.4/jquery-ui.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.5/js/bootstrap.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/flot/0.8.3/jquery.flot.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/pixi.js/3.0.11/pixi.min.js"></script>
<script src="//cdnjs.cloudflare.com/ajax/libs/dat-gui/0.5.1/dat.gui.min.js"></script>

<script src="//storage.googleapis.com/code.getmdl.io/1.0.1/material.min.js"></script>

<script src="../js/lib/Vec.js"></script>
<script src="../js/lib/TileMap.js"></script>
</body>
</html>
